<!DOCTYPE html><html lang="en"><head><title>My notes</title><!-- vis.js--><script src="modules/external/vis-js.min.js"></script><link href="modules/external/vis-js-timeline-graph2d.css" rel="stylesheet" type="text/css"><!-- tagify --><script src="modules/external/tagify.min.js"></script><script src="modules/external/tagify-polyfills.js"></script><link href="modules/external/tagify.min.css" rel="stylesheet" type="text/css"><!-- custom scripts--><script src="modules/internal/script.js"></script><!-- custom styles--><link rel="stylesheet" href="styles/style.css"><link rel="stylesheet" href="styles/timeline.css"><meta name="viewport" content="width=device-width, initial-scale=1.0"></head><body><h1>My notes </h1><h2>Explore</h2><details> <summary>Filters </summary><div> <label for="types-input">Type</label><div class="filter-controls"><button id="reset-types-button">(show all)</button><button id="clear-types-button">(clear all)</button></div><input name="types-input" id="types-input"><label for="tag-input">Tags</label><div class="filter-controls"><button id="reset-tags-button">(show all)</button><button id="clear-tags-button">(clear all)</button></div><input name="tag-input" id="tag-input"></div></details><div id="timelines-container"></div><div><p>Toggle View</p><button class="toggle" id="timeline-toggle"><div class="toggle-switch"></div></button><div id="timeline-yp-container"><h3>By year published</h3><p> <em>Scroll to zoom, drag to pan</em></p><div id="timeline-yp"></div></div><div class="hide" id="timeline-ln-container"> <h3>By last noted</h3><p> <em>Scroll to zoom, drag to pan</em></p><div id="timeline-ln"></div></div></div><div><li> <a href="https://ddooss.org/libros/Jorge_Luis_Borges_ficciones.pdf" target="_blank" rel="noreferrer nofollow noopener"> Borges, Jorge Luis - "Ficciones" (1944)</a></li><li> <a href="https://celmoreblog.files.wordpress.com/2016/05/235449575-silence-shusaku-endo-william-johnston.pdf" target="_blank" rel="noreferrer nofollow noopener"> Endo, Shusaku - "Silence" (1966)</a></li><li> <a href="https://www.amazon.com/Myth-Religion-Transcripts-Alan-Watts/dp/080483055X" target="_blank" rel="noreferrer nofollow noopener"> Watts, Alan - "Myth and Religion" (1996)</a></li><li> <a href="http://philoctetes.free.fr/parmenidesunicode.htm" target="_blank" rel="noreferrer nofollow noopener"> Parmenides - "On Nature" (-480)</a></li></div><script type="text/javascript">//////////////////////////
// GLOBAL STATE 
const globalFilters = {
  types: 'all',
  tags: 'all',
  authors: 'all'
}

let timelineViewIsLp = true

// get notes and info from variable passed into template
const nts = [{"id":"clairefro/gnotes/notes/borges-ficciones.md","fm":{"title":"Ficciones","author":"Borges, Jorge Luis","yearPublished":1944,"type":"ðŸ“• book","link":"https://ddooss.org/libros/Jorge_Luis_Borges_ficciones.pdf","tags":["fiction","infinity"],"lastNoted":"2021-08-16"},"prettyUrl":"https://github.com/clairefro/gnotes/blob/main/notes/borges-ficciones.md","rawUrl":"https://raw.githubusercontent.com/clairefro/gnotes/main/notes/borges-ficciones.md","relPath":"notes/borges-ficciones.md"},{"id":"clairefro/gnotes/notes/endo-shusaku-silence.md","fm":{"title":"Silence","author":"Endo, Shusaku","yearPublished":1966,"type":"ðŸ“• book","link":"https://celmoreblog.files.wordpress.com/2016/05/235449575-silence-shusaku-endo-william-johnston.pdf","tags":["fiction","philosophy","religion","martyrdom","christianity","japan","missionary"],"lastNoted":"2021-12-16"},"prettyUrl":"https://github.com/clairefro/gnotes/blob/main/notes/endo-shusaku-silence.md","rawUrl":"https://raw.githubusercontent.com/clairefro/gnotes/main/notes/endo-shusaku-silence.md","relPath":"notes/endo-shusaku-silence.md"},{"id":"clairefro/gnotes/notes/foo/watts-alan-myth-and-religion.md","fm":{"title":"Myth and Religion","author":"Watts, Alan","yearPublished":1996,"type":"ðŸ“• book","link":"https://www.amazon.com/Myth-Religion-Transcripts-Alan-Watts/dp/080483055X","tags":["philosophy","religion"],"lastNoted":"2021-11-31"},"prettyUrl":"https://github.com/clairefro/gnotes/blob/main/notes/foo/watts-alan-myth-and-religion.md","rawUrl":"https://raw.githubusercontent.com/clairefro/gnotes/main/notes/foo/watts-alan-myth-and-religion.md","relPath":"notes/foo/watts-alan-myth-and-religion.md"},{"id":"clairefro/gnotes/notes/parmenides-on-nature.md","fm":{"title":"On Nature","author":"Parmenides","yearPublished":-480,"type":"ðŸ“œ poem","link":"http://philoctetes.free.fr/parmenidesunicode.htm","tags":["philosophy","presocratic"],"lastNoted":"2021-12-28"},"prettyUrl":"https://github.com/clairefro/gnotes/blob/main/notes/parmenides-on-nature.md","rawUrl":"https://raw.githubusercontent.com/clairefro/gnotes/main/notes/parmenides-on-nature.md","relPath":"notes/parmenides-on-nature.md"}]
const inf = {"repoUrl":"https://github.com/clairefro/gnotes","summary":{"notes":{"count":4},"authors":{"count":4,"map":{"Borges, Jorge Luis":1,"Endo, Shusaku":1,"Watts, Alan":1,"Parmenides":1}},"types":{"count":2,"map":{"ðŸ“• book":3,"ðŸ“œ poem":1}},"tags":{"count":9,"map":{"philosophy":3,"fiction":2,"religion":2,"infinity":1,"martyrdom":1,"christianity":1,"japan":1,"missionary":1,"presocratic":1}},"yearPublished":{"min":-480,"max":1996,"diff":2476}}}

let globalFilteredNotes = [...nts]

//////////////////////////
// TIMELINE (vis.js)

// Set up timelines
const timelineYpEl = document.getElementById('timeline-yp')
const timelineLnEl = document.getElementById('timeline-ln')

const ypDatasetInit = toTimeLineDataset(notesToYpItems(globalFilteredNotes))
const lnDatasetInit = toTimeLineDataset(notesToLnItems(globalFilteredNotes))

const options = {
  showCurrentTime: false,
};

const timelineYp = new vis.Timeline(timelineYpEl, ypDatasetInit, options);
const timelineLn = new vis.Timeline(timelineLnEl, lnDatasetInit, options);

function updateTimelines() {
  const ypDataset = toTimeLineDataset(notesToYpItems(globalFilteredNotes))
  const lnDataset = toTimeLineDataset(notesToLnItems(globalFilteredNotes))

  timelineYp.setItems(ypDataset)
  timelineYp.redraw()

  timelineLn.setItems(lnDataset)
  timelineLn.redraw()
}

function notesToYpItems(_notes) {
  return _notes.map(n => ({ 
    id: n.id, 
    content: buildTimelineContent(n), 
    start: new Date(n.fm.yearPublished, 0, 1)
  }))
}

function notesToLnItems(_notes) {
  return _notes.map(n => ({ 
    id: n.id, 
    content: buildTimelineContent(n), 
    start: new Date(n.fm.lastNoted)
  }))
}

function toTimeLineDataset (_items) {
  return new vis.DataSet(_items)
}

// TODO: Link to templated notes page in static website. Currently links to github
function buildTimelineContent(_note) {
  return `
    <div className="tl-content">
      <a href="${_note.prettyUrl}" target="_blank" rel="noopener noreferrer nofollow">
      <span>${_note.fm.title}</span>
      </a>
    </div>
  `
}

// Toggle timeline views
const timelineToggle = document.getElementById("timeline-toggle")
timelineToggle.addEventListener('click', (e) => {
  e.preventDefault();
  timelineToggle.classList.toggle('active')
  toggleTimelineView()
})

const timelineYpContainer = document.getElementById("timeline-yp-container")
const timelineLnContainer = document.getElementById("timeline-ln-container")

function toggleTimelineView() {
  // in case we need if for something else...
  timelineViewIsLp = !timelineViewIsLp
  timelineYpContainer.classList.toggle("hide")
  timelineLnContainer.classList.toggle("hide")
}

///////////////////////
// TAGIFY 
const sharedTagifyOpts = {
  duplicates: false,
  enforceWhitelist: true,
  skipInvalid: true,
  editTags: false,
  dropdown: { 
    enabled: 1,
    highlightFirst: true 
  },
}
const allTags = Object.keys(inf.summary.tags.map)
const allTypes = Object.keys(inf.summary.types.map)

const tagInput = document.getElementById("tag-input"),
tagsTagifyInput = new Tagify(tagInput, {
  id: 'tags',  // must be unique (per-tagify instance)
  whitelist: allTags,
  ...sharedTagifyOpts
});

const typeInput = document.getElementById("types-input"),
typeTagifyInput = new Tagify(typeInput, {
  id: 'types',  // must be unique (per-tagify instance)
  whitelist: allTypes,
  ...sharedTagifyOpts
});

// Tagify helpers
function resetTagifyInput(tagifyInput, initialTags) {
  tagifyInput.removeAllTags()
  tagifyInput.addTags(initialTags)
}

function clearTagifyInput(tagifyInput) {
  tagifyInput.removeAllTags()
}

// Tagify: tags input
const resetTagsButton = document.getElementById("reset-tags-button")
resetTagsButton.addEventListener('click', onClickResetTags)

const clearTagsButton = document.getElementById("clear-tags-button")
clearTagsButton.addEventListener('click', onClickClearTags)

function onClickResetTags() {
  resetTagifyInput(tagsTagifyInput, allTags)
}

function onClickClearTags() {
  clearTagifyInput(tagsTagifyInput)
}

resetTagifyInput(tagsTagifyInput, allTags)

tagsTagifyInput.on('change', (e) => {
  const filteredTags = tagsTagifyInput.value.map(v => v.value)
  updateGlobalFilter({ tags: filteredTags })
})

// Tagify: type input
const resetTypesButton = document.getElementById("reset-types-button")
resetTypesButton.addEventListener('click', onClickResetTypes)

const clearTypesButton = document.getElementById("clear-types-button")
clearTypesButton.addEventListener('click', onClickClearTypes)

function onClickResetTypes() {
  resetTagifyInput(typeTagifyInput, allTypes)
}

function onClickClearTypes() {
  clearTagifyInput(typeTagifyInput)
}

resetTagifyInput(typeTagifyInput, allTypes)

typeTagifyInput.on('change', (e) => {
  const filteredTypes = typeTagifyInput.value.map(v => v.value)
  updateGlobalFilter({ types: filteredTypes })
})

// Handle filter changes

function updateGlobalFilter(filterInputs) {
  //- update globalFilters, globalNotes and rerender timelineYp
  Object.entries(filterInputs).forEach(([filterName, filterVal]) => {
    globalFilters[filterName] = filterVal
  })
  handleFilterChange()    
}

function handleFilterChange() {
  globalFilteredNotes = filterNotes(nts, inf, globalFilters)
  updateTimelines()
}</script></body></html>